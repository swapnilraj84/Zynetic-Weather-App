"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
exports.loadTheme = loadTheme;
var _compression = _interopRequireDefault(require("compression"));
var _cors = _interopRequireDefault(require("cors"));
var _express = _interopRequireDefault(require("express"));
var _lodash = _interopRequireDefault(require("lodash"));
var _config = require("@verdaccio/config");
var _middleware = require("@verdaccio/middleware");
var _auth = _interopRequireDefault(require("../lib/auth"));
var _config2 = _interopRequireDefault(require("../lib/config"));
var _constants = require("../lib/constants");
var _logger = require("../lib/logger");
var _pluginLoader = _interopRequireDefault(require("../lib/plugin-loader"));
var _storage = _interopRequireDefault(require("../lib/storage"));
var _utils = require("../lib/utils");
var _debug = _interopRequireDefault(require("./debug"));
var _endpoint = _interopRequireDefault(require("./endpoint"));
var _middleware2 = require("./middleware");
var _web = _interopRequireDefault(require("./web"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function loadTheme(config) {
  if (_lodash.default.isNil(config.theme) === false) {
    return _lodash.default.head((0, _pluginLoader.default)(config, config.theme, {}, function (plugin) {
      return plugin.staticPath && plugin.manifest && plugin.manifestFiles;
    }, 'verdaccio-theme'));
  }
}
const defineAPI = function (config, storage) {
  var _config$server;
  const auth = new _auth.default(config);
  const app = (0, _express.default)();

  // run in production mode by default, just in case
  // it shouldn't make any difference anyway
  app.set('env', process.env.NODE_ENV || 'production');

  // Allow `req.ip` to resolve properly when Verdaccio is behind a proxy or load-balancer
  // See: https://expressjs.com/en/guide/behind-proxies.html
  if ((_config$server = config.server) !== null && _config$server !== void 0 && _config$server.trustProxy) {
    app.set('trust proxy', config.server.trustProxy);
  }
  app.use((0, _cors.default)());

  // Router setup
  app.use((0, _middleware.log)(_logger.logger));
  app.use(_middleware2.errorReportingMiddleware);
  if (config.user_agent) {
    app.use(function (req, res, next) {
      res.setHeader('X-Powered-By', (0, _config.getUserAgent)(config.user_agent));
      next();
    });
  } else {
    app.disable('x-powered-by');
  }
  app.use((0, _compression.default)());
  app.get('/-/static/favicon.ico', (0, _middleware2.serveFavicon)(config));

  // Hook for tests only
  if (config._debug) {
    (0, _debug.default)(app, config.self_path);
  }

  // register middleware plugins
  const plugin_params = {
    config: config,
    logger: _logger.logger
  };
  const plugins = (0, _pluginLoader.default)(config, config.middlewares, plugin_params, function (plugin) {
    return plugin.register_middlewares;
  });
  plugins.forEach(plugin => {
    plugin.register_middlewares(app, auth, storage);
  });

  // For  npm request
  app.use((0, _endpoint.default)(config, auth, storage));

  // For WebUI & WebUI API
  if (_lodash.default.get(config, 'web.enable', true)) {
    app.use('/', (0, _web.default)(config, auth, storage));
  } else {
    app.get('/', function (req, res, next) {
      next(_utils.ErrorCode.getNotFound(_constants.API_ERROR.WEB_DISABLED));
    });
  }

  // Catch 404
  app.get('/*', function (req, res, next) {
    next(_utils.ErrorCode.getNotFound(_constants.API_ERROR.FILE_NOT_FOUND));
  });
  app.use(_middleware2.handleError);
  app.use(_middleware.final);
  return app;
};
var _default = async function _default(configHash) {
  (0, _logger.setup)(configHash.logs);
  const config = new _config2.default(_lodash.default.cloneDeep(configHash));
  // register middleware plugins
  const plugin_params = {
    config: config,
    logger: _logger.logger
  };
  const filters = (0, _pluginLoader.default)(config, config.filters || {}, plugin_params, plugin => plugin.filter_metadata);
  const storage = new _storage.default(config);
  // waits until init calls have been initialized
  await storage.init(config, filters);
  return defineAPI(config, storage);
};
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJsb2FkVGhlbWUiLCJjb25maWciLCJfIiwiaXNOaWwiLCJ0aGVtZSIsImhlYWQiLCJsb2FkUGx1Z2luIiwicGx1Z2luIiwic3RhdGljUGF0aCIsIm1hbmlmZXN0IiwibWFuaWZlc3RGaWxlcyIsImRlZmluZUFQSSIsInN0b3JhZ2UiLCJhdXRoIiwiQXV0aCIsImFwcCIsImV4cHJlc3MiLCJzZXQiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJzZXJ2ZXIiLCJ0cnVzdFByb3h5IiwidXNlIiwiY29ycyIsImxvZyIsImxvZ2dlciIsImVycm9yUmVwb3J0aW5nTWlkZGxld2FyZSIsInVzZXJfYWdlbnQiLCJyZXEiLCJyZXMiLCJuZXh0Iiwic2V0SGVhZGVyIiwiZ2V0VXNlckFnZW50IiwiZGlzYWJsZSIsImNvbXByZXNzaW9uIiwiZ2V0Iiwic2VydmVGYXZpY29uIiwiX2RlYnVnIiwiaG9va0RlYnVnIiwic2VsZl9wYXRoIiwicGx1Z2luX3BhcmFtcyIsInBsdWdpbnMiLCJtaWRkbGV3YXJlcyIsInJlZ2lzdGVyX21pZGRsZXdhcmVzIiwiZm9yRWFjaCIsImFwaUVuZHBvaW50Iiwid2ViTWlkZGxld2FyZSIsIkVycm9yQ29kZSIsImdldE5vdEZvdW5kIiwiQVBJX0VSUk9SIiwiV0VCX0RJU0FCTEVEIiwiRklMRV9OT1RfRk9VTkQiLCJoYW5kbGVFcnJvciIsImZpbmFsIiwiY29uZmlnSGFzaCIsInNldHVwIiwibG9ncyIsIkFwcENvbmZpZyIsImNsb25lRGVlcCIsImZpbHRlcnMiLCJmaWx0ZXJfbWV0YWRhdGEiLCJTdG9yYWdlIiwiaW5pdCJdLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hcGkvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNvbXByZXNzaW9uIGZyb20gJ2NvbXByZXNzaW9uJztcbmltcG9ydCBjb3JzIGZyb20gJ2NvcnMnO1xuaW1wb3J0IGV4cHJlc3MsIHsgQXBwbGljYXRpb24gfSBmcm9tICdleHByZXNzJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5cbmltcG9ydCB7IGdldFVzZXJBZ2VudCB9IGZyb20gJ0B2ZXJkYWNjaW8vY29uZmlnJztcbmltcG9ydCB7IGZpbmFsIH0gZnJvbSAnQHZlcmRhY2Npby9taWRkbGV3YXJlJztcbmltcG9ydCB7IGxvZyB9IGZyb20gJ0B2ZXJkYWNjaW8vbWlkZGxld2FyZSc7XG5pbXBvcnQgeyBDb25maWcgYXMgSUNvbmZpZywgSVBsdWdpbk1pZGRsZXdhcmUsIElQbHVnaW5TdG9yYWdlRmlsdGVyIH0gZnJvbSAnQHZlcmRhY2Npby90eXBlcyc7XG5cbmltcG9ydCBBdXRoIGZyb20gJy4uL2xpYi9hdXRoJztcbmltcG9ydCBBcHBDb25maWcgZnJvbSAnLi4vbGliL2NvbmZpZyc7XG5pbXBvcnQgeyBBUElfRVJST1IgfSBmcm9tICcuLi9saWIvY29uc3RhbnRzJztcbmltcG9ydCB7IGxvZ2dlciwgc2V0dXAgfSBmcm9tICcuLi9saWIvbG9nZ2VyJztcbmltcG9ydCBsb2FkUGx1Z2luIGZyb20gJy4uL2xpYi9wbHVnaW4tbG9hZGVyJztcbmltcG9ydCBTdG9yYWdlIGZyb20gJy4uL2xpYi9zdG9yYWdlJztcbmltcG9ydCB7IEVycm9yQ29kZSB9IGZyb20gJy4uL2xpYi91dGlscyc7XG5pbXBvcnQge1xuICAkTmV4dEZ1bmN0aW9uVmVyLFxuICAkUmVxdWVzdEV4dGVuZCxcbiAgJFJlc3BvbnNlRXh0ZW5kLFxuICBJQXV0aCxcbiAgSVN0b3JhZ2VIYW5kbGVyLFxufSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgaG9va0RlYnVnIGZyb20gJy4vZGVidWcnO1xuaW1wb3J0IGFwaUVuZHBvaW50IGZyb20gJy4vZW5kcG9pbnQnO1xuaW1wb3J0IHsgZXJyb3JSZXBvcnRpbmdNaWRkbGV3YXJlLCBoYW5kbGVFcnJvciwgc2VydmVGYXZpY29uIH0gZnJvbSAnLi9taWRkbGV3YXJlJztcbmltcG9ydCB3ZWJNaWRkbGV3YXJlIGZyb20gJy4vd2ViJztcblxuZXhwb3J0IGZ1bmN0aW9uIGxvYWRUaGVtZShjb25maWcpIHtcbiAgaWYgKF8uaXNOaWwoY29uZmlnLnRoZW1lKSA9PT0gZmFsc2UpIHtcbiAgICByZXR1cm4gXy5oZWFkKFxuICAgICAgbG9hZFBsdWdpbihcbiAgICAgICAgY29uZmlnLFxuICAgICAgICBjb25maWcudGhlbWUsXG4gICAgICAgIHt9LFxuICAgICAgICBmdW5jdGlvbiAocGx1Z2luKSB7XG4gICAgICAgICAgcmV0dXJuIHBsdWdpbi5zdGF0aWNQYXRoICYmIHBsdWdpbi5tYW5pZmVzdCAmJiBwbHVnaW4ubWFuaWZlc3RGaWxlcztcbiAgICAgICAgfSxcbiAgICAgICAgJ3ZlcmRhY2Npby10aGVtZSdcbiAgICAgIClcbiAgICApO1xuICB9XG59XG5cbmNvbnN0IGRlZmluZUFQSSA9IGZ1bmN0aW9uIChjb25maWc6IElDb25maWcsIHN0b3JhZ2U6IElTdG9yYWdlSGFuZGxlcik6IGFueSB7XG4gIGNvbnN0IGF1dGg6IElBdXRoID0gbmV3IEF1dGgoY29uZmlnKTtcbiAgY29uc3QgYXBwOiBBcHBsaWNhdGlvbiA9IGV4cHJlc3MoKTtcblxuICAvLyBydW4gaW4gcHJvZHVjdGlvbiBtb2RlIGJ5IGRlZmF1bHQsIGp1c3QgaW4gY2FzZVxuICAvLyBpdCBzaG91bGRuJ3QgbWFrZSBhbnkgZGlmZmVyZW5jZSBhbnl3YXlcbiAgYXBwLnNldCgnZW52JywgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgJ3Byb2R1Y3Rpb24nKTtcblxuICAvLyBBbGxvdyBgcmVxLmlwYCB0byByZXNvbHZlIHByb3Blcmx5IHdoZW4gVmVyZGFjY2lvIGlzIGJlaGluZCBhIHByb3h5IG9yIGxvYWQtYmFsYW5jZXJcbiAgLy8gU2VlOiBodHRwczovL2V4cHJlc3Nqcy5jb20vZW4vZ3VpZGUvYmVoaW5kLXByb3hpZXMuaHRtbFxuICBpZiAoY29uZmlnLnNlcnZlcj8udHJ1c3RQcm94eSkge1xuICAgIGFwcC5zZXQoJ3RydXN0IHByb3h5JywgY29uZmlnLnNlcnZlci50cnVzdFByb3h5KTtcbiAgfVxuXG4gIGFwcC51c2UoY29ycygpKTtcblxuICAvLyBSb3V0ZXIgc2V0dXBcbiAgYXBwLnVzZShsb2cobG9nZ2VyKSk7XG4gIGFwcC51c2UoZXJyb3JSZXBvcnRpbmdNaWRkbGV3YXJlKTtcbiAgaWYgKGNvbmZpZy51c2VyX2FnZW50KSB7XG4gICAgYXBwLnVzZShmdW5jdGlvbiAocmVxOiAkUmVxdWVzdEV4dGVuZCwgcmVzOiAkUmVzcG9uc2VFeHRlbmQsIG5leHQ6ICROZXh0RnVuY3Rpb25WZXIpOiB2b2lkIHtcbiAgICAgIHJlcy5zZXRIZWFkZXIoJ1gtUG93ZXJlZC1CeScsIGdldFVzZXJBZ2VudChjb25maWcudXNlcl9hZ2VudCkpO1xuICAgICAgbmV4dCgpO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGFwcC5kaXNhYmxlKCd4LXBvd2VyZWQtYnknKTtcbiAgfVxuXG4gIGFwcC51c2UoY29tcHJlc3Npb24oKSk7XG5cbiAgYXBwLmdldCgnLy0vc3RhdGljL2Zhdmljb24uaWNvJywgc2VydmVGYXZpY29uKGNvbmZpZykpO1xuXG4gIC8vIEhvb2sgZm9yIHRlc3RzIG9ubHlcbiAgaWYgKGNvbmZpZy5fZGVidWcpIHtcbiAgICBob29rRGVidWcoYXBwLCBjb25maWcuc2VsZl9wYXRoKTtcbiAgfVxuXG4gIC8vIHJlZ2lzdGVyIG1pZGRsZXdhcmUgcGx1Z2luc1xuICBjb25zdCBwbHVnaW5fcGFyYW1zID0ge1xuICAgIGNvbmZpZzogY29uZmlnLFxuICAgIGxvZ2dlcjogbG9nZ2VyLFxuICB9O1xuXG4gIGNvbnN0IHBsdWdpbnM6IElQbHVnaW5NaWRkbGV3YXJlPElDb25maWc+W10gPSBsb2FkUGx1Z2luKFxuICAgIGNvbmZpZyxcbiAgICBjb25maWcubWlkZGxld2FyZXMsXG4gICAgcGx1Z2luX3BhcmFtcyxcbiAgICBmdW5jdGlvbiAocGx1Z2luOiBJUGx1Z2luTWlkZGxld2FyZTxJQ29uZmlnPikge1xuICAgICAgcmV0dXJuIHBsdWdpbi5yZWdpc3Rlcl9taWRkbGV3YXJlcztcbiAgICB9XG4gICk7XG4gIHBsdWdpbnMuZm9yRWFjaCgocGx1Z2luOiBJUGx1Z2luTWlkZGxld2FyZTxJQ29uZmlnPikgPT4ge1xuICAgIHBsdWdpbi5yZWdpc3Rlcl9taWRkbGV3YXJlcyhhcHAsIGF1dGgsIHN0b3JhZ2UpO1xuICB9KTtcblxuICAvLyBGb3IgIG5wbSByZXF1ZXN0XG4gIGFwcC51c2UoYXBpRW5kcG9pbnQoY29uZmlnLCBhdXRoLCBzdG9yYWdlKSk7XG5cbiAgLy8gRm9yIFdlYlVJICYgV2ViVUkgQVBJXG4gIGlmIChfLmdldChjb25maWcsICd3ZWIuZW5hYmxlJywgdHJ1ZSkpIHtcbiAgICBhcHAudXNlKCcvJywgd2ViTWlkZGxld2FyZShjb25maWcsIGF1dGgsIHN0b3JhZ2UpKTtcbiAgfSBlbHNlIHtcbiAgICBhcHAuZ2V0KCcvJywgZnVuY3Rpb24gKHJlcTogJFJlcXVlc3RFeHRlbmQsIHJlczogJFJlc3BvbnNlRXh0ZW5kLCBuZXh0OiAkTmV4dEZ1bmN0aW9uVmVyKSB7XG4gICAgICBuZXh0KEVycm9yQ29kZS5nZXROb3RGb3VuZChBUElfRVJST1IuV0VCX0RJU0FCTEVEKSk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBDYXRjaCA0MDRcbiAgYXBwLmdldCgnLyonLCBmdW5jdGlvbiAocmVxOiAkUmVxdWVzdEV4dGVuZCwgcmVzOiAkUmVzcG9uc2VFeHRlbmQsIG5leHQ6ICROZXh0RnVuY3Rpb25WZXIpIHtcbiAgICBuZXh0KEVycm9yQ29kZS5nZXROb3RGb3VuZChBUElfRVJST1IuRklMRV9OT1RfRk9VTkQpKTtcbiAgfSk7XG4gIGFwcC51c2UoaGFuZGxlRXJyb3IpO1xuICBhcHAudXNlKGZpbmFsKTtcblxuICByZXR1cm4gYXBwO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgKGFzeW5jIGZ1bmN0aW9uIChjb25maWdIYXNoOiBhbnkpOiBQcm9taXNlPGFueT4ge1xuICBzZXR1cChjb25maWdIYXNoLmxvZ3MpO1xuICBjb25zdCBjb25maWc6IElDb25maWcgPSBuZXcgQXBwQ29uZmlnKF8uY2xvbmVEZWVwKGNvbmZpZ0hhc2gpKTtcbiAgLy8gcmVnaXN0ZXIgbWlkZGxld2FyZSBwbHVnaW5zXG4gIGNvbnN0IHBsdWdpbl9wYXJhbXMgPSB7XG4gICAgY29uZmlnOiBjb25maWcsXG4gICAgbG9nZ2VyOiBsb2dnZXIsXG4gIH07XG4gIGNvbnN0IGZpbHRlcnMgPSBsb2FkUGx1Z2luKFxuICAgIGNvbmZpZyxcbiAgICBjb25maWcuZmlsdGVycyB8fCB7fSxcbiAgICBwbHVnaW5fcGFyYW1zLFxuICAgIChwbHVnaW46IElQbHVnaW5TdG9yYWdlRmlsdGVyPElDb25maWc+KSA9PiBwbHVnaW4uZmlsdGVyX21ldGFkYXRhXG4gICk7XG4gIGNvbnN0IHN0b3JhZ2U6IElTdG9yYWdlSGFuZGxlciA9IG5ldyBTdG9yYWdlKGNvbmZpZyk7XG4gIC8vIHdhaXRzIHVudGlsIGluaXQgY2FsbHMgaGF2ZSBiZWVuIGluaXRpYWxpemVkXG4gIGF3YWl0IHN0b3JhZ2UuaW5pdChjb25maWcsIGZpbHRlcnMpO1xuICByZXR1cm4gZGVmaW5lQVBJKGNvbmZpZywgc3RvcmFnZSk7XG59KTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFBa0M7QUFFM0IsU0FBU0EsU0FBUyxDQUFDQyxNQUFNLEVBQUU7RUFDaEMsSUFBSUMsZUFBQyxDQUFDQyxLQUFLLENBQUNGLE1BQU0sQ0FBQ0csS0FBSyxDQUFDLEtBQUssS0FBSyxFQUFFO0lBQ25DLE9BQU9GLGVBQUMsQ0FBQ0csSUFBSSxDQUNYLElBQUFDLHFCQUFVLEVBQ1JMLE1BQU0sRUFDTkEsTUFBTSxDQUFDRyxLQUFLLEVBQ1osQ0FBQyxDQUFDLEVBQ0YsVUFBVUcsTUFBTSxFQUFFO01BQ2hCLE9BQU9BLE1BQU0sQ0FBQ0MsVUFBVSxJQUFJRCxNQUFNLENBQUNFLFFBQVEsSUFBSUYsTUFBTSxDQUFDRyxhQUFhO0lBQ3JFLENBQUMsRUFD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